
%\tikzloadlibrary{calc}
\begin{figure}
\centering
\framebox{
\begin{tikzpicture}[scale=.8]

\def\x{0};
\def\y{3.5};


\node [anchor=west] at (\x-.5,\y+  5) {$\Pi^{\textsf{ext-S}}: \OOT^{\rec},$ FS,  RO $\rightarrow\OOT^\send$};
\draw                  (\x-.5,\y+4.7) --                                                               (\x+4.8,\y+4.7);
\draw [thick, <-]      (\x,\y+4.5) -- node  [pos=1,right]{$\mes_\A$}                                (\x+  1,\y+4.5);
\draw [thick, ->]      (\x,\y+  4) -- node  [pos=1,right]{$\mes_\B$}                                (\x+  1,\y+4);
\draw [thick, <-]      (\x,\y+3.5) -- node  [pos=1,right]{$ U, ZKP(\H(U))$}                         (\x+  1,\y+3.5);
\draw [thick, ->]      (\x,\y+  3) -- node  [pos=1,right]{$k$}                                      (\x+  1,\y+3);

\def\x{9};

\node [anchor=west] at (\x-.5,\y+  5) {$\Pi^{\textsf{ext-S}}: \OOT^{\rec},$ RO $\rightarrow\OOT^\send$};
	\draw                  (\x-.5,\y+4.7) --                                                               (\x+4,\y+4.7);
\draw [thick, <-]      (\x,\y+4.5) -- node  [pos=1,right]{$\mes_\A$}                                (\x+  1,\y+4.5);
\draw [thick, ->]      (\x,\y+  4) -- node  [pos=1,right]{$\mes_\B$}                                (\x+  1,\y+4);
\draw [thick, <-]      (\x,\y+3.5) -- node  [pos=1,right]{$U$}                           			(\x+  1,\y+3.5);
\draw [thick, ->]      (\x,\y+3) -- node  [pos=1,right]{$c,k$}                                		(\x+  1,\y+3);
\draw [thick, <-]      (\x,\y+2.5) -- node  [pos=1,right]{$ZKP(c)$}                                 (\x+  1,\y+2.5);



\def\x{0};
\def\y{0};

\node [anchor=west] at (\x-.5,\y+  5) {$\Pi^{\textsf{ext-R}}: \OOT^{\send u},$ FS,  RO $\rightarrow\OOT^\rec$};
\draw                  (\x-.5,\y+4.7) --                                                               (\x+4.8,\y+4.7);
\draw [thick, ->]      (\x,\y+4.5) -- node  [pos=1,right]{$\mes_\A$}                                (\x+  1,\y+4.5);
\draw [thick, <-]      (\x,\y+  4) -- node  [pos=1,right]{$\mes_\B, U, ZKP(\H(U)),$ $u$-select.}(\x+  1,\y+4);



\def\x{9};


\node [anchor=west] at (\x-.5,\y+5) {$\Pi^{\textsf{ext-R}}: \OOT^{\send u},$RO $\rightarrow\OOT^\rec$};
\draw             (\x-.5,\y+4.7)    --                                                    (\x+4,\y+4.7);
\draw [thick, ->] (\x,\y+4.5)    -- node  [pos=1,right]{$\mes_\A$}                     (\x+  1,\y+4.5);
\draw [thick, <-] (\x,\y+  4)    -- node  [pos=1,right]{$\mes_\B, U,$ $u$-select.} (\x+  1,\y+  4);
\draw [thick, ->] (\x,\y+3.5)    -- node  [pos=1,right]{$c$}                           (\x+  1,\y+3.5);
\draw [thick, <-] (\x,\y+  3)    -- node  [pos=1,right]{$ZKP(c)$}                      (\x+  1,\y+  3);


\def\x{0};
\def\y{3};

\node [anchor=west] at (\x-.5,{5-\y}) {$\Pi^{\textsf{ext-U}}: \OOT^{\send u},$ FS,  RO $\rightarrow\OOT^\U$};
\draw                  (\x-.5,{4.7-\y}) --                                                               ({\x+4.8},{4.7-\y});
\draw [thick, ->]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A, \textsf{Com}(k)$}              ({\x+  1},{4.5-\y});
\draw [thick, <-]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B, U, ZKP(\H(U)),$ $u$-select.}({\x+  1},{4  -\y});
\draw [thick, ->]      (\x,{3.5-\y}) -- node  [pos=1,right]{$\textsf{Decom}(k)$}                     ({\x+  1},{3.5-\y});

\def\x{9};
\node [anchor=west] at (\x-.5,5-\y) {$\Pi^{\textsf{ext-U}}: \OOT^{\send u},$RO $\rightarrow\OOT^\U$};
\draw             (\x-.5,4.7-\y)    --                                                    (\x+4,4.7-\y);
\draw [thick, ->] (\x,4.5-\y)    -- node  [pos=1,right]{$\mes_\A, \textsf{Com}(k)$}   (\x+  1,4.5-\y);
\draw [thick, <-] (\x,4  -\y)    -- node  [pos=1,right]{$\mes_\B, U,$ $u$-select.} (\x+  1,  4-\y);
\draw [thick, ->] (\x,3.5-\y)    -- node  [pos=1,right]{$c,\textsf{Decom}(k)$}        (\x+  1,3.5-\y);
\draw [thick, <-] (\x,  3-\y)    -- node  [pos=1,right]{$ZKP(c)$}                      (\x+  1,  3-\y);








\def\x{0};
\def\y{6};

\node [anchor=west] at (\x-.5,{5-\y}) {$\Pi^{\textsf{ext-S}\pi}: \OOT^{\rec},$ FS, IC $\rightarrow\OOT^\send$};
\draw                  (\x-.5,{4.7-\y}) --                                      ({\x+4.8},{4.7-\y});
\draw [thick, <-]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A$}       ({\x+  1},{4.5-\y});
\draw [thick, ->]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B$}       ({\x+  1},{4  -\y});
\draw [thick, <-]      (\x,{3.5-\y}) -- node  [pos=1,right]{$U, ZKP(\H(U))$.}({\x+  1},{3.5-\y});
\draw [thick, ->]      (\x,{3  -\y}) -- node  [pos=1,right]{$k$}             ({\x+  1},{3  -\y});

\def\x{9};
\node [anchor=west] at (\x-.5,5-\y) {$\Pi^{\textsf{ext-S}\pi}: \OOT^{\U u},$ IC $\rightarrow\OOT^\rec$};
\draw             (\x-.5,4.7-\y)    --                                                            (\x+4,4.7-\y);
\draw [thick, <-]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A$}       ({\x+  1},{4.5-\y});
\draw [thick, ->]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B$}       ({\x+  1},{4  -\y});
\draw [thick, <-]      (\x,{3.5-\y}) -- node  [pos=1,right]{$U$.}({\x+  1},{3.5-\y});
\draw [thick, ->]      (\x,{3  -\y}) -- node  [pos=1,right]{$c,k$}             ({\x+  1},{3  -\y});
\draw [thick, <-]      (\x,{2.5-\y}) -- node  [pos=1,right]{$ZKP(c)$.}({\x+  1},{2.5-\y});

\def\x{0};
\def\y{9.5};


\node [anchor=west] at (\x-.5,{5-\y}) {$\Pi^{\textsf{ext-R}\pi}: \OOT^{\U u},$ FS, IC $\rightarrow\OOT^\rec$};
\draw                  (\x-.5,{4.7-\y}) --                                                               ({\x+4.8},{4.7-\y});
\draw [thick, <-]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A, \textsf{Com}(u)$}        ({\x+  1},{4.5-\y});
\draw [thick, ->]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B$}                                ({\x+  1},{4  -\y});
\draw [thick, <-]      (\x,{3.5-\y}) -- node  [pos=1,right]{$\textsf{Decom}(u), U, ZKP(\H(U)),$ $u$-select.}({\x+  1},{3.5-\y});

\def\x{9};
\node [anchor=west] at (\x-.5,5-\y) {$\Pi^{\textsf{ext-R}\pi}: \OOT^{\U u},$ IC $\rightarrow\OOT^\rec$};
\draw             (\x-.5,4.7-\y)    --                                                            (\x+4,4.7-\y);
\draw [thick, <-]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A, \textsf{Com}(u)$}        ({\x+  1},{4.5-\y});
\draw [thick, ->]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B$}                         ({\x+  1},{4  -\y});
\draw [thick, <-]      (\x,{3.5-\y}) -- node  [pos=1,right]{$\textsf{Decom}(u), U,$ $u$-select.}({\x+  1},{3.5-\y});
\draw [thick, ->]      (\x,{3  -\y}) -- node  [pos=1,right]{$c$}                              ({\x+  1},{3  -\y});
\draw [thick, <-]      (\x, 2.5-\y)  -- node  [pos=1,right]{$ZKP(c)$}                         (\x+  1,2.5-\y);


\def\x{0};
\def\y{13};


\node [anchor=west] at (\x-.5,{5-\y}) {$\Pi^{\textsf{ext-U}\pi}: \OOT^{\U u},$ FS, IC $\rightarrow\OOT^\U$};
\draw                  (\x-.5,{4.7-\y}) --                                                                   ({\x+4.8},{4.7-\y});
\draw [thick, <-]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A, \textsf{Com}(u)$}                   ({\x+  1},{4.5-\y});
\draw [thick, ->]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B, \textsf{Com}(k)$}                   ({\x+  1},{4  -\y});
\draw [thick, <-]      (\x,{3.5-\y}) -- node  [pos=1,right]{$\textsf{Decom}(u), U, ZKP(\H(U)),$ $u$-select.}({\x+  1},{3.5-\y});
\draw [thick, ->]      (\x,{  3-\y}) -- node  [pos=1,right]{$\textsf{Decom}(k)$}                          ({\x+  1},{3-\y});

\def\x{9};
\node [anchor=west] at (\x-.5,5-\y) {$\Pi^{\textsf{ext-U}\pi}: \OOT^{\U u},$ IC $\rightarrow\OOT^\U$};
\draw             (\x-.5,4.7-\y)    --                                                            (\x+4,4.7-\y);
\draw [thick, <-]      (\x,{4.5-\y}) -- node  [pos=1,right]{$\mes_\A, \textsf{Com}(u)$}        ({\x+  1},{4.5-\y});
\draw [thick, ->]      (\x,{4  -\y}) -- node  [pos=1,right]{$\mes_\B, \textsf{Com}(k)$}        ({\x+  1},{4  -\y});
\draw [thick, <-]      (\x,{3.5-\y}) -- node  [pos=1,right]{$\textsf{Decom}(u), U,$ $u$-select.} ({\x+  1},{3.5-\y});
\draw [thick, ->]      (\x,{3  -\y}) -- node  [pos=1,right]{$c,\textsf{Decom}(k)$}             ({\x+  1},{3  -\y});
\draw [thick, <-]      (\x, 2.5-\y)  -- node  [pos=1,right]{$ZKP(c)$}                          (\x+  1,2.5-\y);



\end{tikzpicture}
}

\caption{Messages flow for our various OT extension protocols. The protocols on the left have the Fiat-Shamir transformation applied, where the challenge value $c$ is replaced with $\H(U)$. $\mes_\A,\mes_\B$ are the first and second messages of the base OTs. $U$ is the OT extension matrix. $ZKP(x)$ is the proof that $U$ is correct given a challenge value of $x\in\{\H(U),c\}$. $u$ is a seed used to randomized the sender or receiver chosen message OTs into uniform message OTs. $u$ must be committed to in the first round. $u$-select similarly transforms the receiver's selection into a uniform selection.  $k$ is the key used to generated the output messages as described in \sectionref{sec:otext}. \label{fig:OTDataflow}}
\end{figure}