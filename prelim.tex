\section{Preliminaries}

\subsection{Notation}
$\sec$ denotes the security parameter and for $n\in\mathbb N$, $[n]:=\{1,\dots,n\}$. We use $\Pi^{\A,\B}$, $\Pi$ when $\A$ and $\B$ are clear from the context,  to denote a protocol between two parties \A and \B. $\langle \A,\B\rangle$ denotes as the transcript of the protocol, which consists of all the messages sent between them. We use $(\A(a),\B(b))_{\Pi}$ to denote the joint output distribution of $\A$ and \B when interacting in protocol $\Pi$ with inputs $a$ and $b$.


\begin{definition}[Random Oracle]
A \emph{random oracle} over a set of domains and an image is a collection of functions \H that map an element $q$ within one of the domains  to a uniform element $\H(q)$ in the image.  
\end{definition}


\begin{definition}[Ideal Cipher]
An \emph{ideal cipher} over a set of tuples of domains and an image is a collection of functions $\pi$ such that for any element $\key$ of the first domain, $\pi_\key$ is a permutation that map an element $q$ within the second domain to a uniform element $\pi_{\key}(q)$ in the image.  
\end{definition}

\subsection{Key Agreement}

\begin{figure}[h!]
\centering
\framebox{
\begin{tikzpicture}
\node [anchor=west] at (0,5) {\A:};
\node [anchor=west] at (7,5) {\B:};
\node [anchor=west] at (0,4.5){$\mes_\A\leftarrow\A(\tape_\A)$};
\draw [thick, ->] (3.75,4.5)-- node [midway,above]{$\mes_\A$}(6.75,4.5);
\node [anchor=west] at (7,4){$\mes_\B\leftarrow\B(\tape_\B,\mes_\A)$};
\draw [thick, <-] (3.75,4)-- node [midway,above]{$\mes_\B$}(6.75,4);
\node [anchor=west] at (0,3.5) {$\key_\A=\EK(\tape_\A,\mes_\B)$};
\node [anchor=west] at (7,3.5) {$\key_\B=\EK(\tape_\B,\mes_\A)$};
\end{tikzpicture}
}
\label{fig:UKA}
\caption{The figure shows a key agreement protocol between parties \A and \B with random tapes $\tape_\A$ and $\tape_\B$. For correctness, we require $\key_\A=\key_\B$.}
\end{figure}


\begin{definition}[(Two Message) Uniform Key Agreement (\UKA)] 
Let \G be a group.
We call a protocol $\Pi$ between two ppt parties \A and \B (two message) uniform key agreement if \A first sends a message $\mes_\A\in\G$ to \B and \B responds with a final message $\mes_\B$ and in the end, both establish a common key $\key$ (see Figure~\ref{fig:UKA}) using a key establish algorithm \EK. Further, we require three properties:
\begin{description}
\item[Correctness:]
$$
\Pr[\key_\A=\EK(\tape_\A,\mes_\B)=\EK(\tape_\B,\mes_\A)=\key_\B]\geq 1-\negl,
$$
where $\tape_\A\leftarrow\bits^*$, $\tape_\B\leftarrow\bits^*$, $\mes_\A\leftarrow\A(\tape_\A)$ and $\mes_\B\leftarrow\B(\tape_\B)$.
\item [Key Indistinguishability:] For any ppt distinguisher \D,
$$ 
|\Pr[\D(1^\sec,\langle \A,\B\rangle, \key)=1]-\Pr[\D(1^\sec,\langle \A,\B\rangle, u)=1]|=\negl,
$$
where $\key$ is the established key between \A and \B and $u$ is a uniform element from the key domain.
\item [Uniformity:] For any ppt distinguisher \D, 
$$
|\Pr[\D(1^\sec,\mes_\A)=1]-\Pr[\D( 1^\sec,u)=1]|=\negl,
$$
where $u$ is a uniform element from \G and $\mes_\A\leftarrow\A(\tape_\A)$.
\end{description}
When \A and \B can send their messages concurrently, we call it a $1$-round \UKA otherwise a $2$-round \UKA.
\end{definition}

In Appendix~\ref{sec:addKA}, we define different security notions when executing multiple instances of a key agreement. All the considered notions follow from the standard notions from above, but potentially with a polynomial security loss. 


\subsection{Oblivious Transfer}



\begin{definition}[Ideal $k$-out-of-$n$ Oblivious Transfer]\label{def:ot}
An \emph{ideal $k$-out-of-$n$ oblivious transfer} is a functionality that interacts with two parties, a sender \send and a receiver \rec. Let $\set\subseteq[n]$ of size $k$ and  $s_1,...,s_n\in \{0,1\}^\ell$.

The functionality is publicly parameterized by one of the following message sampling methods:
\begin{description}
\item[] \textsc{Sender Chosen Message:} $\send$ sends the circuit $\mathcal{M} : [n] \rightarrow \{0,1\}^\ell$ to the functionality which defines $s_i:=\mathcal{M}(i)$.

\item[] \textsc{Receiver Chosen Message:} \rec sends the circuit  $\mathcal{M} : [k] \rightarrow \{0,1\}^\ell$ to the functionality which defines $s_{\set_i}:=\mathcal{M}(i)$ for $i\in[k]$ and uniformly samples $s_i\gets\{0,1\}^\ell$ for $i\in\set\setminus[n]$.

\item[] \textsc{Uniform Message:} The functionality uniformly samples $s_i\gets\{0,1\}^{\ell}$ for $i\in[n]$. 
 
\item[] \textsc{Endemic Chosen Message:} If $\send$ is corrupt, then $\send$ sends the circuit $\mathcal{M} : [n] \rightarrow \{0,1\}^\ell$ to the functionality which defines $s_i:=\mathcal{M}(i)$.

If \rec is corrupt, \rec sends the circuit  $\mathcal{M} : [k] \rightarrow \{0,1\}^\ell$ to the functionality which defines $s_{\set_i}:=\mathcal{M}(i)$ for $i\in[k]$.

All remaining $s_i$ for $i\in [n]$ are uniformly samples $s_i\gets\{0,1\}^\ell$.
\end{description}

The functionality is publicly parameterized by one of the following selection methods:
\begin{description}
	\item[] \textsc{Receiver Selection:} \rec sends the circuit $\mathcal{S}:[n]\rightarrow\{0,1\}$ to the functionality where the support of $\mathcal{S}$ is of size $k$. The functionality defines $\set:=\{i \mid \mathcal{S}(i)=1\}$.
	\item[] \textsc{Uniform Selection:} The functionality uniformly samples $\set\gets\mathbb{P}([n])$ s.t. $|\set|=k$.
\end{description}

As specified by the message sampling method, the oracle receives the circuit $\mathcal{M}$ from the appropriate party if one is called for.  As specified by the selection method, the functionality receives the circuit $\mathcal{S}$ if one is called for. 
Thereafter, upon receiving the message $(\textsc{Output}, i)$ from \send, respond with $s_i$. Upon receiving $(\textsc{Output}, i)$ from \rec and if $i\in \set$,  respond with $s_i$. 

We denote the ideal functionalities for Sender Chosen, Receiver Chosen, Uniform and Endemic Chosen Message with Receiver Selection as $\OOT^\send, \OOT^\rec,\OOT^\U,\OOT^\E$, respectively. The analogous oracles for Uniform Selection are denoted as  $\OOT^{\send u},$ $\OOT^{\rec u}, \OOT^{\U u}, \OOT^{\E u}$, respectively.
\end{definition}
\begin{remark}
	When $n$ is polynomial in the security parameter $\kappa$, we simplify \definitionref{def:ot} to allow the parties directly input the appropriate $s_i$ messages as opposed to specifying a circuit $\mathcal{M}$. Similarly for the set $\set:=\{i \mid \mathcal{S}(i)=1\}$. Lastly, instead of querying the oracle with $(\textsc{Output}, i)$, the oracle sends $(s_i)_{i\in [n]}$ to \send and $(\set, (s_i)_{i\in\set})$ to \rec. This simplification can trivially be simulated when $n=\textsf{poly}(\kappa)$.
\end{remark}




\begin{definition}[$k$ out of $n$ Oblivious Transfer ($\OT_{k,n}$)]\label{def:otSec}
We call a protocol $\Pi$ between two ppt parties, a sender \send and a receiver \rec, a \emph{$k$ out of $n$ oblivious transfer} if %\rec has as input a set $\set\subset[n]$ of size $k$ and 
at the end, \send outputs $n$ strings $(s_i)_{i\in[n]}$ and \rec outputs $(s_i)_{i\in\set}$ and a set $\set\subset[n]$ s.t. $|\set|=k$. For security, we require two properties with respect to a functionality \OOT.
\begin{description}
\item[Security Against a Malicious Sender:] For any ppt adversary \Adv, there exists a ppt adversary \Adv' such that for any ppt distinguisher \D
$$
|\Pr[\D((\Adv,\rec)_{\Pi})=1] -\Pr[\D( (\Adv', \OOT))=1]|=\negl,
$$
where all algorithms receive input $1^\sec$. \rec additionally receives input \set.
\item[Security Against a Malicious Receiver:] For any ppt adversary \Adv, there exists a ppt adversary \Adv' such that for any ppt distinguisher \D
$$
|\Pr[\D((\send, \Adv)_{\Pi})=1] -\Pr[\D((\OOT,\Adv'))=1]|=\negl,
$$
where all algorithms receive input $1^\sec$.
\end{description}


\textcolor{red}{TODO: update this to incorporate ``Uniform Selection"} We distinguish four different message security notions.
\begin{description}
\item[Uniform Message Security:] The OT is secure with respect to $\OOT^\U$, i.e. $\OOT^\U$-secure.
\item[Sender Chosen Message Security:] The OT is secure with respect to $\OOT^{\send}$, i.e. $\OOT^{\send}$-secure.
\item[Receiver Chosen Message Security:] The OT is secure with respect to $\OOT^{\rec}$, i.e. $\OOT^{\rec}$-secure.
\item[Endemic Security:] The OT is secure with respect to $\OOT^{\E}$, i.e. $\OOT^{\E}$-secure.
\end{description}


\end{definition}

\begin{remark}
$\OOT^\U$-security is the strongest security definition since a malicious party cannot tweak the distribution of the strings  $(s_i)_{i\in[n]}$. Endemic security gives the weakest security guarantees since in both cases, the malicious receiver and malicious sender case, the adversary can potentially choose the strings $(s_i)_{i\in\set}$.
\end{remark}

