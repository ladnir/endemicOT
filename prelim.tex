\section{Preliminaries}

\subsection{Notation}
$\sec$ denotes the security parameter and for $n\in\mathbb N$, $[n]:=\{1,\dots,n\}$. We use $\langle \A,\B\rangle$ to denote a protocol between two parties \A and \B as well as the transcript of the protocol, which consists of all the messages sent between them. We use $(\A(a),\B(b))_{\langle \A,\B\rangle}$ to denote the joint output distribution of $\A$ and \B when interacting in protocol $\langle \A,\B\rangle$ with inputs $a$ and $b$.


\begin{definition}[Random Oracle]
A \emph{random oracle} over a set of domains and an image is a collection of functions \H that map an element $q$ within one of the domains  to a uniform element $\H(q)$ in the image.  
\end{definition}


\subsection{Key Agreement}

\begin{figure}[h!]
\centering
\begin{tikzpicture}
\node [anchor=west] at (0,5) {\A:};
\node [anchor=west] at (7,5) {\B:};
\node [anchor=west] at (0,4.5){$\mes_\A\leftarrow\A(\tape_\A)$};
\draw [thick, ->] (3.75,4.5)-- node [midway,above]{$\mes_\A$}(6.75,4.5);
\node [anchor=west] at (7,4){$\mes_\B\leftarrow\B(\tape_\B,\mes_\A)$};
\draw [thick, <-] (3.75,4)-- node [midway,above]{$\mes_\B$}(6.75,4);
\node [anchor=west] at (0,3.5) {$\key_\A=\EK(\tape_\A,\mes_\B)$};
\node [anchor=west] at (7,3.5) {$\key_\B=\EK(\tape_\B,\mes_\A)$};
\end{tikzpicture}
\label{fig:UKA}
\caption{The figure shows a key agreement protocol between parties \A and \B with random tapes $\tape_\A$ and $\tape_\B$. For correctness, we require $\key_\A=\key_\B$.}
\end{figure}


\begin{definition}[(Two Message) Uniform Key Agreement (\UKA)] 
Let \G be a group.
We call a protocol $\langle \A,\B\rangle$ between two ppt parties \A and \B (two message) uniform key agreement if \A first sends a message $\mes_\A\in\G$ to \B and \B responds with a final message $\mes_\B$ and in the end, both establish a common key $\key$ (see Figure~\ref{fig:UKA}) using a key establish algorithm \EK. Further, we require three properties:
\begin{description}
\item[Correctness:]
$$
\Pr[\key_\A=\EK(\tape_\A,\mes_\B)=\EK(\tape_\B,\mes_\A)=\key_\B]\geq 1-\negl,
$$
where $\tape_\A\leftarrow\bits^*$, $\tape_\B\leftarrow\bits^*$, $\mes_\A\leftarrow\A(\tape_\A)$ and $\mes_\B\leftarrow\B(\tape_\B)$.
\item [Key Indistinguishability:] For any ppt distinguisher \D,
$$ 
|\Pr[\D(1^\sec,\langle \A,\B\rangle, \key)=1]-\Pr[\D(1^\sec,\langle \A,\B\rangle, u)=1]|=\negl,
$$
where $\key$ is the established key between \A and \B and $u$ is a uniform element from the key domain.
\item [Uniformity:] For any ppt distinguisher \D, 
$$
|\Pr[\D(1^\sec,\mes_\A)=1]-\Pr[\D( 1^\sec,u)=1]|=\negl,
$$
where $u$ is a uniform element from \G.
\end{description}
When \A and \B can send their messages concurrently, we call it a $1$-round \UKA otherwise a $2$-round \UKA.
\end{definition}

\begin{definition}[One-Round Uniform Key Agreement]
We call a \UKA \emph{One-Round Uniform Key Agreement} if the function $\mes_{\B}\leftarrow\B(\tape_{\B},\mes_\A)$ does not depend on $\mes_A$ and can be computed solely using input $\tape_{\B}$. More precisely, there is a function $\B'$ such that for any $\mes_{\A}$, $\B'(\tape_{\B})=\B(\tape_{\B},\mes_{\A})$, which we will in the following refer to with $\B$ as well. 
\end{definition}

\begin{definition}[Multi-Instance Uniformity]
We call a \UKA $Q$ \emph{multi-instance uniform} if for any ppt distinguisher \D,
$$
|\Pr[\D^{\O_{\A}}(1^{\sec})]=1]-Pr[\D^{\O_{u}}(1^{\sec})=1]|=\negl,
$$
where $\O_{\A}$ outputs $\mes_\A\leftarrow\A(\tape_\A)$ for fresh randomness $\tape_\A$ and $\O_u$ outputs $u\leftarrow\G$ and $Q$ is a bound on the amount of queries to $\O_{u}$, $\O_{\A}$.
\end{definition}



\begin{definition}[Multi-Instance Key Indistinguishability]
We call a \UKA $(Q,n)$ \emph{multi-instance key indistinguishable} if for any ppt distinguisher \D,
$$
|\Pr[\D^{\O_{\langle \A,\B\rangle}, \O_{\key}}(1^{\sec})]=1]-Pr[\D^{\O_{\langle \A,\B\rangle},\O_{u}}(1^{\sec})=1]|=\negl,
$$
where $\O_{\langle \A,\B\rangle}$ outputs on the $i$-th query a transcript $\T_i:=\langle \A_i,\B_i\rangle$, $\O_{\key}$ outputs on query $j$, key $\key_j=\EK(\tape_{\A,j},\mes_{\B,j})=\EK(\tape_{\B,j},\mes_{\A,j})$ that matches transcript $\T_i$. $\O_u$ outputs a uniform element $u$ from the key domain. $\O_{\langle \A,\B\rangle}$ uses fresh random tapes $\tape_{\A,i},\tape_{\B,i}\leftarrow\bits^*$ for every query. $Q$ is a bound on the amount of queries to $\O_{\langle \A,\B\rangle}$, where $n$ bounds the amount of queries to $\O_{\key}$, $\O_{u}$. 
\end{definition}

In case of a one-round \UKA, we define a stronger version of the multi-instance key indistinguishability, which we call one-round multi-instance key indistinguishability.

\begin{definition}[One Round Multi-Instance Key Indistinguishability]
We call a one-round \UKA $(Q,n)$ \emph{one-round multi-instance key indistinguishability} if for any ppt distinguisher \D,
$$
|\Pr[\D^{\O_{\A}, \O_{\key}}(1^{\sec},\mes_\B)]=1]-Pr[\D^{\O_{\A},\O_{u}}(1^{\sec},\mes_\B)=1]|=\negl,
$$
where $\mes_{\B}\leftarrow\B(\tape_{\B})$ for uniform $\tape_{\B}$. $\O_{\A}$ outputs on the $i$-th query $\mes_{\A,i}\leftarrow \A(\tape_{\A,i})$ for uniform $\tape_{\A,i}$. $\O_{\key}$ outputs on query $j$, key $\key_j=\EK(\tape_{\A,j},\mes_{\B})=\EK(\tape_{\B},\mes_{\A})$. $\O_u$ outputs a uniform element $u$ from the key domain. $Q$ is a bound on the amount of queries to $\O_{\A}$, where $n$ bounds the amount of queries to $\O_{\key}$, $\O_{u}$. 
\end{definition}

 
\begin{lemma}
Let \UKA be uniform except probability $\epsilon$, then it is $Q$ multi-instance uniform except at most probability $Q\epsilon$.
\end{lemma}
\begin{proof}
This follows straightforwardly from using a simple hybrid argument. Hybrid $\hyb_{i}$ samples $\mes_{\A,j}$ for $j\leq i$ from $\O_u$ and for $j>i$ from $\O_{\A}$. If there is an adversary that distinguishes $\hyb_i$ from $\hyb_{i+1}$ for any $i$, then we can break the uniformity of \UKA by distinguishing $\mes_{\A,i+1}$ from uniform.  
\end{proof}

\begin{lemma}\label{lem:keytomultkey}
Let \UKA be key indistinguishable except probability $\epsilon$, then it is $(Q,n)$ multi-instance key indistinguishable except at most probability $Q\epsilon$. 
\end{lemma}

\begin{proof}
Again, we use a hybrid argument over hybrids $\hyb_i$. In $\hyb_i$, $(\mes_{\A,j},\mes_{\B,j}),\key_j$ is sampled from $\O_{\langle \A,\B\rangle}\times\O_u$ for $j\leq i$ and from $\O_{\langle \A,\B\rangle}\times\O_\key$ for $j>i$. If one distinguishes $\hyb_i$ from $\hyb_{i+1}$ for some $i$, one breaks the key indistinguishability. 
\end{proof}

\begin{lemma}
Let a one-round \UKA be key indistinguishable except probability $\epsilon$, then it is $(Q,n)$ one-round multi-instance key indistinguishable except at most probability $Q\epsilon$. 
\end{lemma}

\begin{proof}
This lemma follows for the same reason as Lemma~\ref{lem:keytomultkey}.
\end{proof}

\subsection{Oblivious Transfer}



\begin{definition}[Ideal $k$-out-of-$n$ Oblivious Transfer]\label{def:ot}
An \emph{ideal $k$-out-of-$n$ oblivious transfer} is an oracle that interacts with two parties, a sender \send and a receiver \rec. Let $\set\subseteq[n]$ of size $k$ and  $s_1,...,s_n\in \{0,1\}^\ell$. The oracle concludes by sending $(s_i)_{i\in[n]}$ to \send and $(s_i)_{i\in\set}$ to \rec.

We distinguish four methods for choosing the strings $s_1,...,s_n\in \{0,1\}^\ell$:
\begin{description}
\item[Sender Chosen Message:] $\send$ sends $(m_i)_{i\in[n]}$ to the oracle which defines $s_i:=m_i$.
\item[Receiver Chosen Message:] \rec sends $(m_i)_{i\in[k]}$ to the oracle which defines $s_{\set_i}:=m_i$ for $i\in[k]$ and uniformly samples $s_i\gets\{0,1\}^\ell$ for $i\in\set\setminus[n]$.
\item[Uniform Message:] The oracle uniformly samples $s_i\gets\{0,1\}^{\ell}$ for $i\in[n]$.  
\item[Endemic Ideal OT:] If $\send$ is corrupt, then $\send$ sends $(m_i)_{i\in[n]}$ to the oracle which defines $s_i:=m_i$.
If \rec is corrupt, \rec sends $(m_i)_{i\in[k]}$ to the oracle which defines $s_{\set_i}:=m_i$ for $i\in[k]$. Any undefined $s_i$ for $i\in [n]$ are sampled uniformly at random from $\{0,1\}^\ell$.
\end{description}

We distinguish two methods for choosing the set $\set\in[n]$ of size $k$:
\begin{description}
	\item[Receiver Selection:] \rec sends the set $\set$ to the oracle.
	\item[Uniform Selection:] The oracle uniformly samples $\set\gets\mathbb{P}([n])$ s.t. $|\set|=k$.
\end{description}

\end{definition}

\begin{definition}[$k$ out of $n$ Oblivious Transfer ($\OT_{k,n}$)]\label{def:otSec}
We call a protocol $\langle \send,\rec \rangle$ between two ppt parties, a sender \send and a receiver \rec, a \emph{$k$ out of $n$ oblivious transfer} if \rec has as input a set $\set\subset[n]$ of size $k$ and at the end, \send outputs $n$ strings $(s_i)_{i\in[n]}$ and \rec outputs $(s_i)_{i\in\set}$. For security, we require two properties with respect to an ideal OT \OOT.
\begin{description}
\item[Security Against a Malicious Sender:] For any ppt adversary \Adv, there exists a ppt adversary \Adv' such that for any ppt distinguisher \D
$$
|\Pr[\D((\Adv,\rec)_{\langle \Adv, \rec\rangle})=1] -\Pr[\D( (\Adv', \O_{\OT, \rec})_{\langle \Adv', \OOT\rangle})=1]|=\negl,
$$
where $\O_{\OT, \rec}$ is the \rec's side output within the view of \OOT and all algorithms receive input $1^\sec$. \rec additionally receives input \set.
\item[Security Against a Malicious Receiver:] For any ppt adversary \Adv, there exists a ppt adversary \Adv' such that for any ppt distinguisher \D
$$
|\Pr[\D((\send, \Adv)_{\langle \send, \Adv\rangle})=1] -\Pr[\D((\O_{\OT,\send},\Adv')_{\langle \OOT , \Adv' \rangle})=1]|=\negl,
$$
where $\O_{\OT,\send}$ is  the \send's side output within the view of \OOT and all algorithms receive input $1^\sec$.
\end{description}
We distinguish four different security notions.
\begin{description}
\item[Uniform Security:] The OT is secure with respect to $\OOT^u$.
\item[Sender Tweakable Security:] The OT is secure with respect to $\OOT^{\send}$.
\item[Receiver Tweakable Security:] The OT is secure with respect to $\OOT^{\rec}$.
\item[Endemic Security:] The OT is secure with respect to $\OOT^{e}$.
\end{description}
\end{definition}

\begin{remark}
Uniform security is the strongest security definition since a malicious party cannot tweak the distribution of the strings  $(s_i)_{i\in[n]}$. Endemic security gives the weakest security guarantees since in both cases, the malicious receiver and malicious sender case, the adversary can potentially choose the strings $(s_i)_{i\in\set}$.
\end{remark}

