\section{Relations between OT Security Notions}


\begin{figure}[h!]
\centering
\begin{tikzpicture}
\node (U) at (4,4) {Uniform Security};
\node (SC) at (0,2) {Sender Tweakable};
\node (RC) at (8,2) {Receiver Tweakable};
\node (E) at (4,0) {Endemic Security};
\node (TC) at (3,2) {Coin Tossing};
\draw [-implies,double equal sign distance] (U) -- (SC);
\draw [-implies,double equal sign distance] (U) -- (RC);
\draw [-implies,double equal sign distance] (SC) -- (E);
\draw [-implies,double equal sign distance] (RC) -- (E);
\draw [->, thick] (U) -- (TC);
\draw [->, thick] (E) --(5,2.5)-- (U);
\draw [-, thick] (5,2.5)-- (TC);
\draw [->, thick] (E) .. controls (1,0.75) .. (SC);
\draw [->, thick] (E) .. controls (7,0.75) .. (RC);
\end{tikzpicture}
\label{fig:OTrelations}
\caption{
The figure depicts the different security notions of OT and their relations. $A\Rightarrow B$ denotes that security $A$ implies security $B$. $A\rightarrow B$ denotes that any OT realizing security $A$ can be efficiently transformed into an OT realizing security $B$.
}
\end{figure}

\begin{lemma}
Let the distribution of OT strings be efficiently sampleable. 
Then a uniform security implies sender as well as a receiver tweakable security. If \OT is a sender or receiver tweakable secure, then it is also an endemically secure.
\end{lemma}

\begin{proof}
In the first step, we show that uniform security implies sender tweakable security and receiver tweakable security implies endemic security. These two implications result from the same simple fact that a malicious sender interacting with the ideal OT is easier to construct when it can choose the OT strings rather than if it receives the strings from the ideal OT. The following claim formalizes this fact. 
\begin{claim}\label{claim:utocs}
Let \OT be secure against a malicious sender with respect to an ideal OT $\OOT^*$ that sends the OT strings $(s_i)_{i\in[n]}$ to the sender, i.e. oracle $\OOT^u$ and $\OOT^{\rec}$, and the distribution of $(s_i)_{i\in[n]}$ is efficiently sampleable. Then \OT is also secure against a malicious sender with respect to ideal OT $\OOT^{\send}$, which receives the OT strings $(s_i)_{i\in[n]}$ from the sender.
\end{claim}


\begin{proof}
We show that if there is an adversary that breaks the security against a malicious security with respect to ideal OT $\OOT^{\send}$ then there is also an adversary that breaks the security with respect to $\OOT'$. More precisely, if there is a ppt adversary $\Adv_1$ such that for any ppt adversary $\Adv_1'$ there exists a ppt distinguisher $\D_1$ with 
$$
|\Pr[\D_1((\Adv_1,\rec)_{\langle \Adv_1, \rec\rangle})=1] -\Pr[\D_1( (\Adv'_1, \O_{\OT, \rec}^{\send})_{\langle \Adv_1', \OOT^{\send}\rangle})=1]|=\epsilon,
$$
where $\O_{\OT, \rec}^{\send}$ is the \rec's side output within the view of $\OOT^{\send}$ and all algorithms receive input $1^\sec$. \rec additionally receives input \set.
Then there is also a ppt adversary $\Adv_2$ such that for any ppt adversary $\Adv_2'$ there exists a ppt distinguisher $\D_2$ with 
$$
|\Pr[\D_2((\Adv_2,\rec)_{\langle \Adv_2, \rec\rangle})=1] -\Pr[\D_1( (\Adv'_2, \O_{\OT, \rec}^*)_{\langle \Adv_2', \OOT^*\rangle})=1]|=\epsilon,
$$
where $\O_{\OT, \rec}^*$ is the \rec's side output within the view of $\OOT^*$ and all algorithms receive input $1^\sec$. \rec additionally receives input \set.

We set $\Adv_2:=\Adv_1$ and $\D_2:=\D_1$. Further, for any $\Adv_2'$, there is an $\Adv_1'$  such that the distribution of $(\Adv'_2, \O_{\OT, \rec}^*)_{\langle \Adv_2', \OOT^*\rangle}$ is identical with the distribution $(\Adv'_1, \O_{\OT, \rec}^{\send})_{\langle \Adv_1', \OOT^{\send}\rangle}$. This follows from the fact that  $\Adv_1'$ could choose the OT strings $(s_i)_{i\in[n]}$  from the same distribution as $\OOT^*$ does and otherwise follow the description of $\Adv_2'$. Since $\D_1$ is successful for any $\Adv_1'$ it will be also for any $\Adv_2'$, which can be seen as a special case on over the set of all ppt adversaries $\Adv_1'$.
\end{proof}

The remaining two implications, from uniform security to receiver tweakable security and from sender tweakable security to endemic security follow in a similar fashion. Again it is easier to construct a malicious receiver interacting with the ideal OT when he can choose the OT strings rather than receiving them from the ideal OT.
\begin{claim}\label{claim:utocr}
Let \OT be secure against a malicious receiver with respect to an ideal OT $\OOT^*$ that sends the learned OT strings $(s_i)_{i\in\set}$ to the receiver, i.e. oracle $\OOT^u$ and $\OOT^{\send}$, and the distribution of $(s_i)_{i\in\set}$ is efficiently sampleable. Then \OT is also secure against a malicious sender with respect to ideal OT $\OOT^{\rec}$, which receives the OT strings $(s_i)_{i\in\set}$ from the receiver.
\end{claim}

\begin{proof}
The proof is basically identical to the proof of Claim~\ref{claim:utocs}. Again, the set of all ppt $\Adv_2'$ is a subset of the set of all ppt $\Adv_1'$ and identical with the set of all $\Adv_1'$ that sample  $(s_i)_{i\in\set}$ from the same distribution as when sent by $\OOT^*$.
\end{proof}

\end{proof}








\paragraph{Transformations.} 


\begin{figure}[t]
	\framebox{\begin{minipage}{0.95\linewidth}
			Input: The sender $\send$ has input $s_1,...,s_n\in \{0,1\}^\ell$ while the receiver $\rec$ has input $\set\subseteq [n]$ of size $k$.
			\begin{enumerate}
				\item \label{step:senderChosen_step1} The parties invoke $\O^{e}_{k,n}$ where $\rec$ takes the role of the receiver with inputs $\set$. $\send$ obtains $(m_i)_{i\in[n]}$ and $\rec$ obtains $(m_i)_{i\in \set}$ from  $\O^{e}_{k,n}$. 
				\item \label{step:senderChosen_step2}  $\send$ sends the strings $r_1,...,r_n$ to $\rec$ where $r_i:=s_i\oplus m_i$.
				\item \label{step:senderChosen_step3}  $\rec$ outputs $(s_i)_{i\in \set}$ where $s_i:=m_i\oplus r_i$.
	\end{enumerate}\end{minipage}}
	\caption{Sender Chosen OT Protocol $\Pi^{\send}_{k,n}$ in the $\O^{e}_{k,n}$ hybrid (\definitionref{def:ot}).}
	\label{fig:protoSendOT}
\end{figure}


\begin{lemma}
	$\Pi^{\send}_{k,n}$ of \figureref{fig:protoSendOT} realizes the Sender Chosen Ideal OT $\OOT^{\send}$ (\definitionref{def:ot}) with unconditional security in the $\O^{e}_{k,n}$ hybrid.
\end{lemma}

\begin{proof}
	First let us consider any corrupt sender $\Adv_1$. We construct a new adversary $\Adv_1'$ which interacts with the oracle $\O^{\send}_{k,n}$ and produces an identical output  to $\Adv_1$.  $\Adv_1'$ plays the role of $\O^{e}_{k,n}$ and $\rec$ in $\Pi^{\send}_{k,n}$ while running $\Adv_1$. $\Adv_1'$ receives the endemic OT strings $m_1,...,m_n$ from $\Adv_1$ in \stepref{step:senderChosen_step1}, along with the strings $r_1,...,r_n$ in \stepref{step:senderChosen_step2}.  $\Adv_1'$ extracts the OT strings of $\Adv_1$ as $s_i:=r_i\oplus m_i$. $\Adv_1'$ sends $(s_i)_{i\in [n]}$ to $\O^{\send}_{k,n}$ and outputs whatever $\Adv_1$ outputs.
	
	Observe that the output of the honest receiver is identical when $\Adv_1$ interacts with $\rec$ in $\Pi^{\send}_{k,n}$ and when $\Adv_1'$ interacts with $\O^{\send}_{k,n}$.
	
	
	Now let us consider a corrupt receiver $\Adv_2$. We construct a new adversary $\Adv_2'$ which interacts with the oracle $\O^{\send}_{k,n}$ and produces an identical output distribution to $\Adv_2$. $\Adv_2'$ plays the role of $\O^{e}_{k,n}$ and $\send$ in $\Pi^{\send}_{k,n}$ while running $\Adv_2$. $\Adv_2'$ receives the set $\set\subset[n]$ of size $k$ and the endemic OT strings $(m_i)_{i\in \set}$ from $\Adv_2$ in \stepref{step:senderChosen_step1}. $\Adv_2'$ sends $\set$ to  $\O^{\send}_{k,n}$ and receives $(s_i)_{i\in \set}$ in response. $\Adv_2'$ computes $r_i:=s_i\oplus m_i$ for $i\in \set$ and uniformly samples $r_i\gets \{0,1\}^\ell$ for $i\in [n]\setminus \set$. $\Adv_2'$ sends $r_1,...,r_n$ to $\Adv_2$ and outputs whatever $\Adv_2$ outputs.

	The transcripts of $\Adv_2$ in these two interactions are identical except for $(r_i)_{i\in [n]\setminus \set}$. Observer that in the real interaction for $i\in [n]\setminus\set$, $r_i:=s_i\oplus m_i$ where $m_i$ is sampled uniformly at random  by the oracle $\O^{e}_{k,n}$ and is independent of the transcript of $\Adv_2$ (conditioned on $r_i$). Therefore sampling $r_i$ directly induces an identical distribution. 
	
	Therefore, any distinguishing advantage $\Adv_1$ or $\Adv_2$ produces in protocol $\Pi^{\send}_{k,n}$ implies that $\Adv_1'$ or $\Adv_2'$ would produce the same advantage against the instantiation of $\O^{e}_{k,n}$, i.e. $\negl$.
\end{proof}


\begin{figure}[t]
	\framebox{\begin{minipage}{0.95\linewidth}
			Input: The sender $\send$ has no input while the receiver $\rec$ has input $\set\subseteq [n]$ of size $k$ and $(s_i)_{i\in \set}$ where $s_i\in \{0,1\}^\ell$.
			\begin{enumerate}
				\item \label{step:receiverChosen_step1} The parties invoke $\O^{e}_{k,n}$ where $\rec$ takes the role of the receiver with inputs $\set$. $\send$ obtains $(m_i)_{i\in[n]}$ and $\rec$ obtains $(m_i)_{i\in \set}$ from  $\O^{e}_{k,n}$. 
				\item \label{step:receiverChosen_step2}  $\rec$ sends the strings $r_1,...,r_n$ to $\send$ where $r_i:=s_i\oplus m_i$ for $i\in \set$ and $r_i\gets\{0,1\}^\ell$ for $i\in [n]\setminus\set$.
				\item \label{step:receiverChosen_step3}  $\send$ outputs $(s_i)_{i\in [n]}$ where $s_i:=m_i\oplus r_i$.
	\end{enumerate}\end{minipage}}
	\caption{Receiver Chosen OT Protocol $\Pi^{\rec}_{k,n}$ in the $\O^{e}_{k,n}$ hybrid (\definitionref{def:ot}).}
	\label{fig:protoRecvOT}
\end{figure}


\begin{lemma}
	$\Pi^{\rec}_{k,n}$ of \figureref{fig:protoRecvOT} realizes the Receiver Chosen Ideal OT $\OOT^{\rec}$ (\definitionref{def:ot}) with unconditional security in the $\O^{e}_{k,n}$ hybrid.
\end{lemma}

\begin{proof}
	First let us consider any corrupt sender $\Adv_1$. We construct a new adversary $\Adv_1'$ which interacts with the oracle $\O^{\rec}_{k,n}$ and produces an identical output distribution as $\Adv_1$.  $\Adv_1'$ plays the role of $\O^{e}_{k,n}$ and $\rec$ in $\Pi^{\rec}_{k,n}$ while running $\Adv_1$. $\Adv_1'$ receives the endemic OT strings $m_1,...,m_n$ from $\Adv_1$ in \stepref{step:receiverChosen_step1}. $\Adv_1'$ invokes $\O^{\rec}_{k,n}$ as the sender and receives $s_1,...,s_n$ in response. $\Adv_1'$ sends $r_1,...,r_n$ to $\Adv_1$ where $r_i:=m_1\oplus s_i$ and 	 outputs whatever $\Adv_1$ outputs.
	
	The transcripts of $\Adv_1$ in these two interactions are identical except for $(r_i)_{i\in [n]\setminus \set}$. Observer that in the real interaction for $i\in [n]\setminus\set$, $r_i\gets\{0,1\}^\ell$ while $\Adv_1'$ chooses $r_i:=m_1\oplus s_i$ where $s_i$ is sampled uniformly at random by $\O^{\rec}_{k,n}$. Therefore computing $r_i:=m_1\oplus s_i$ is identically distributed to $r_i\gets\{0,1\}^\ell$ given that $s_i\gets\{0,1\}^\ell$ is independent of the transcript of $\Adv_1$. 
	
	
	Now let us consider a corrupt receiver $\Adv_2$. We construct a new adversary $\Adv_2'$ which interacts with the oracle $\O^{\rec}_{k,n}$ and produces an identical output as $\Adv_2$. $\Adv_2'$ plays the role of $\O^{e}_{k,n}$ and $\send$ in $\Pi^{\rec}_{k,n}$ while running $\Adv_2$. $\Adv_2'$ receives the set $\set\subset[n]$ of size $k$ and the endemic OT strings $(m_i)_{i\in \set}$ from $\Adv_2$ in \stepref{step:receiverChosen_step1}. $\Adv_2'$ receives $r_1,...,r_n$ from $\Adv_2$ in \stepref{step:receiverChosen_step2} and extracts $(s_i)_{i\in \set}$ as $s_i:=r_i\oplus m_i$. $\Adv_2'$ sends $\set$ and $(s_i)_{i\in \set}$ to $\O^{\rec}_{k,n}$ and outputs whatever $\Adv_2$ outputs.
	
	The output distribution of he honest sender is identical in these two interactions is identical except for $(s_i)_{i\in [n]\setminus \set}$. In the real interaction \send outputs $s_i:=m_i\oplus r_i$ where $m_i$ is sampled uniformly by $\O^{e}_{k,n}$ and independent of the transcript. Therefore $\O^{\rec}_{k,n}$ sampling $s_i\gets\{0,1\}^\ell$ directly is identically distributed.
	
	Therefore, any distinguishing advantage adversary $\Adv_1$ or $\Adv_2$ produces in protocol $\Pi^{\rec}_{k,n}$ implies  that $\Adv_1'$ or $\Adv_2'$ would produce the same advantage against the instantiation of $\O^{e}_{k,n}$, i.e. $\negl$.
\end{proof}



\begin{figure}[t]
	\framebox{\begin{minipage}{0.95\linewidth}
			Input: The sender \send has no input and the  receiver \rec has input $\set\subseteq [n]$ of size $k$.
			\begin{enumerate}
				\item \label{step:uniform_step1} The parties invoke $\O^{e}_{k,n}$ where $\rec$ takes the role of the receiver with inputs $\set$. \send receives $(m_i)_{i\in [n]}$ and \rec receives $(m_i)_{i\in \set}$ where $m_i\in\{0,1\}^\ell$.
				\item \label{step:uniform_step3} The parties invoke $\O^{\coin}$ to receive $n\ell$ coins $r_1,...,r_n\in \{0,1\}^\ell$. 
				\item \send outputs $(s_i)_{i\in [n]}$ and \rec outputs $(s_i)_{i\in \set}$ where $s_i:=m_i\oplus r_i$.
			\end{enumerate}
	\end{minipage}}
	\caption{ Uniform  OT Protocol $\Pi^{u}_{k,n}$ in the $\O^{e}_{k,n},\O^{\coin}$ hybrid (\definitionref{def:ot}).}
	\label{fig:uniformOT}
\end{figure}


\begin{lemma}
	$\Pi^{u}_{k,n}$ of \figureref{fig:uniformOT} realizes the Uniform Ideal OT $\OOT^{\rec}$ (\definitionref{def:ot}) with unconditional security in the $\O^{e}_{k,n},\O^{\coin}$ hybrid.
\end{lemma}
\begin{proof}
	First let us consider any corrupt sender $\Adv_1$. We construct a new adversary $\Adv_1'$ which interacts with the oracle $\O^{u}_{k,n}$ and produces an identical output distribution as $\Adv_1$.  $\Adv_1'$ plays the role of $\O^{e}_{k,n},\O^{\coin}$ and $\rec$ in $\Pi^{u}_{k,n}$ while running $\Adv_1$. $\Adv_1'$ receives the endemic OT strings $m_1,...,m_n$ from $\Adv_1$ in \stepref{step:uniform_step1}.
	
	
	$\Adv_1'$ invokes $\O^{u}_{k,n}$ as the sender and receives $s_1,...,s_n$ in response. When $\Adv_1$ invokes $\O^{\coin}$ during \stepref{step:uniform_step3} $\Adv_1'$ sends $r_1,...,r_n$ to $\Adv_1$ on behalf of $\O^{\coin}$ where $r_i:=m_1\oplus s_i$ and outputs whatever $\Adv_1$ outputs. Observe that $s_i$ is sampled uniformly at random by $\O^{u}_{k,n}$ and is independent of the transcript of $\Adv_1$ (conditioned on $r_i$). Therefore computing $r_i:=m_1\oplus s_i$ induces an identical distribution as $r_i\gets\{0,1\}^\ell$.
	
	Now let us consider a corrupt receiver $\Adv_2$. We construct a new adversary $\Adv_2'$ which interacts with the oracle $\O^{\rec}_{k,n}$ and produces an identical output as $\Adv_2$. $\Adv_2'$ plays the role of $\O^{e}_{k,n},\O^{\coin}$ and $\send$ in $\Pi^{\rec}_{k,n}$ while running $\Adv_2$. $\Adv_2'$ receives the set $\set\subset[n]$ of size $k$ and the endemic OT strings $(m_i)_{i\in \set}$ from $\Adv_2$ in \stepref{step:uniform_step1}. 
	
	
	$\Adv_2'$ invokes  $\O^{u}_{k,n}$ as the receiver with input $\set$ and receives $(s_i)_{i\in\set}$ in response. When $\Adv_2$ invokes $\O^{\coin}$ during \stepref{step:uniform_step3} $\Adv_2'$ sends $r_1,...,r_n$ to $\Adv_1$ on behalf of $\O^{\coin}$ where $r_i:=m_1\oplus s_i$ for $i\in \set$ and otherwise sets $r_i$ as the output of $\O^\coin$. $\Adv_2'$ outputs whatever $\Adv_2$ outputs.
	
	The transcripts of these two interactions are identical except for the messages $(r_i)_{i\in \set}$. In the real interaction $r_i$ is sampled uniformly at random by $\O^{\coin}$ as opposed to $\Adv_2'$ computing $r_i:=m_i\oplus s_i$. Observe that $s_i$ is sampled uniformly at random by $\O^{u}_{k,n}$ and is independent of the transcript of $\Adv_2$ (conditioned on $r_i$). Therefore computing $r_i:=m_1\oplus s_i$ induces an identical distribution as $r_i\gets\{0,1\}^\ell$.

	Therefore, any distinguishing advantage adversary $\Adv_1$ or $\Adv_2$ produces in protocol $\Pi^{u}_{k,n}$ implies that $\Adv_1'$ or $\Adv_2'$ would produce the same advantage against the instantiation of $\O^{e}_{k,n}$ or $\O^\coin$, i.e. $\negl$.
	
\end{proof}
























\begin{figure}[t]
	\framebox{\begin{minipage}{0.95\linewidth}
			Input: The sender \send and receiver \rec have no input.
			\begin{enumerate}
				\item \label{step:coin_step1} \rec sends $\set:=[k]$ to $\O^{u}_{k,n}$ and receives $(s_i)_{i\in \set}$ in response. \send receives $(s_i)_{i\in [n]}$. 
				\item \label{step:coin_step2} Both parties output the bits of $(s_i)_{i\in [k]}$.
			\end{enumerate}
	\end{minipage}}
	\caption{Coin flipping Protocol $\Pi^{\coin}$ in the $\O^{u}_{k,n}$ hybrid.}
	\label{fig:coinFlip}
\end{figure}


\begin{lemma}
	$\Pi^{\textsf{coin}}$ of \figureref{fig:coinFlip} realizes an ideal coin flipping protocol with unconditional security  in the $\O^{u}_{k,n}$ hybrid  (\definitionref{def:ot}).
\end{lemma}
\begin{proof}
	Trivial.
\end{proof}
